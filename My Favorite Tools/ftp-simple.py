#!/usr/bin/env python
# Designed for use with boofuzz v0.0.8
from boofuzz import *


def main():
    """
    This example is a very simple FTP fuzzer. It uses no process monitory
    (procmon) and assumes that the FTP server is already running.
    """
    session = Session(target=Target(connection=SocketConnection("192.168.11.177", 21)))

    s_initialize("user")
    s_static("USER")
    s_static(" ")
    s_string("anonymous")
    s_static("\r\n")

    s_initialize("pass")
    s_static("PASS")
    s_static(" ")
    s_string("anonymous")
    s_static("\r\n")

    s_initialize("STOR")
    s_static("STOR")
    s_static(" ")
    s_static("anonymous")
    s_static("\r\n")


    session.connect(s_get("user"))
    session.connect(s_get("user"), s_get("pass"))
    session.connect(s_get("pass"), s_get("STOR"))

    session.fuzz()


if __name__ == "__main__":
    main()
